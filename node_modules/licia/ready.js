var fns = [],
    _listener,
    doc = document,
    hack = doc.documentElement.doScroll,
    domContentLoaded = 'DOMContentLoaded',
    loaded = (hack ? /^loaded|^c/ : /^loaded|^i|^c/).test(doc.readyState);

if (!loaded) {
    doc.addEventListener(
        domContentLoaded,
        (_listener = function listener() {
            doc.removeEventListener(domContentLoaded, _listener);
            loaded = 1;

            while ((_listener = fns.shift())) {
                _listener();
            }
        })
    );
}

exports = function exports(fn) {
    loaded ? setTimeout(fn, 0) : fns.push(fn);
};

module.exports = exports;
